---

# ЁЯМ│ Entropy ржПржмржВ Gini Impurity

Decision TreeтАУрждрзЗ рж╕ржмржЪрзЗрзЯрзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржХрж╛ржЬ рж╣рж▓рзЛ
ЁЯСЙ **ржХрзЛржи feature ржжрж┐рзЯрзЗ split ржХрж░рж▓рзЗ ржбрзЗржЯрж╛ рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржЖрж▓рж╛ржжрж╛ рж╣ржмрзЗ**
ржПржЯрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рж╛ред

ржПржЗ тАЬржнрж╛рж▓рзЛтАЭтАУржЯрж╛ ржорж╛ржкрж╛рж░ ржЬржирзНржпржЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ
ЁЯФ╣ **Entropy**
ЁЯФ╣ **Gini Impurity**

---

## ЁЯФе Entropy ржХрзА?

**Entropy** рж╣рж▓рзЛ ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ
ЁЯСЙ **ржХрждржЯрж╛ ржЕржирж┐рж╢рзНржЪржпрж╝рждрж╛ / ржмрж┐рж╢рзГржЩрзНржЦрж▓рж╛ (impurity)** ржЖржЫрзЗ
рждрж╛рж░ ржПржХржЯрж┐ ржкрж░рж┐ржорж╛ржкред

### рж╕рж╣ржЬ ржнрж╛рж╖рж╛ржпрж╝:

* ржбрзЗржЯрж╛ ржпржжрж┐ ржкрзБрж░рзЛржкрзБрж░рж┐ ржкрж░рж┐рж╖рзНржХрж╛рж░ (ржПржХржЗ class) рж╣ржпрж╝ тЖТ Entropy = 0
* ржбрзЗржЯрж╛ ржпржжрж┐ рж╕ржорзНржкрзВрж░рзНржг ржорж┐рж╢рзНрж░ рж╣ржпрж╝ тЖТ Entropy ржмрзЗрж╢рж┐

---

### ЁЯУР Entropy ржПрж░ Formula

$$
	ext{Entropy}(S) = - \sum_{i=1}^{n} p_i \, \log_2(p_i)
$$

ржпрзЗржЦрж╛ржирзЗ,

* $p_i$ = i-th class ржПрж░ probability

---

### ЁЯза Entropy Intuition

ржзрж░рж╛ ржпрж╛ржХ:

* рззрзжржЯрж┐ ржбрзЗржЯрж╛
* рззрзжржЯрж┐ржЗ тАЬYesтАЭ

ЁЯСЙ Entropy = **0** (ржХрзЛржирзЛ confusion ржирзЗржЗ)

ржХрж┐ржирзНрждрзБ ржпржжрж┐:

* рзлржЯрж┐ тАЬYesтАЭ
* рзлржЯрж┐ тАЬNoтАЭ

ЁЯСЙ Entropy = **1** (рж╕ржмржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ confusion)

---

### ЁЯзк Entropy ржЙржжрж╛рж╣рж░ржг

ржзрж░рж┐ ржПржХржЯрж┐ node ржП:

* Yes = 6
* No = 4

Probability:

* $p(\text{Yes}) = 6/10 = 0.6$
* $p(\text{No}) = 4/10 = 0.4$

$$
	ext{Entropy} = - \big(0.6\,\log_2 0.6 + 0.4\,\log_2 0.4\big) \approx 0.97
$$

ЁЯСЙ ржорж╛ржирзЗ ржбрзЗржЯрж╛ ржПржЦржирзЛ ржкрзБрж░рзЛржкрзБрж░рж┐ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржирж╛ред

---

## тЪб Gini Impurity ржХрзА?

**Gini Impurity** ржмрж▓рзЗ ржжрзЗрзЯтАФ
ЁЯСЙ **ржПржЗ node ржерзЗржХрзЗ randomly ржПржХржЯрж┐ ржбрзЗржЯрж╛ ржирж┐рж▓рзЗ, ржнрзБрж▓ржнрж╛ржмрзЗ classify рж╣ржУрзЯрж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛ ржХржд?**

---

### ЁЯУР Gini Impurity ржПрж░ Formula

$$
	ext{Gini} = 1 - \sum_{i=1}^{n} p_i^2
$$

---

### ЁЯза Gini Intuition

* рж╕ржм ржбрзЗржЯрж╛ ржпржжрж┐ ржПржХ class рж╣ржпрж╝ тЖТ Gini = 0
* ржбрзЗржЯрж╛ ржпржжрж┐ рж╕ржорж╛ржиржнрж╛ржмрзЗ ржорж┐рж╢рзНрж░ рж╣ржпрж╝ тЖТ Gini ржмрзЗрж╢рж┐

---

### ЁЯзк Gini ржЙржжрж╛рж╣рж░ржг

ржЖржЧрзЗрж░ ржПржХржЗ ржбрзЗржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж┐:

* Yes = 6 тЖТ $p = 0.6$
* No = 4 тЖТ $p = 0.4$

$$
	ext{Gini} = 1 - (0.6^2 + 0.4^2) = 1 - (0.36 + 0.16) = 0.48
$$

---

## ЁЯФН Entropy ржмржирж╛ржо Gini Impurity

| ржмрж┐рж╖рзЯ        | Entropy                  | Gini Impurity       |
| ----------- | ------------------------ | ------------------- |
| ржнрж┐рждрзНрждрж┐      | Information Theory       | Probability         |
| ржорж╛ржирзЗрж░ range | 0 тЖТ 1                    | 0 тЖТ 0.5 (binary)    |
| ржЧржгржирж╛        | рждрзБрж▓ржирж╛ржорзВрж▓ржХ ржЬржЯрж┐рж▓           | рж╕рж╣ржЬ ржУ ржжрзНрж░рзБржд         |
| Sensitivity | ржЫрзЛржЯ ржкрж░рж┐ржмрж░рзНрждржирзЗржУ sensitive | ржХржо sensitive        |
| ржмрзНржпржмрж╣рзГржд рж╣рзЯ  | ID3, C4.5                | CART (Scikit-learn) |

---

## ЁЯза Decision Tree ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ?

* **ID3 / C4.5** тЖТ Entropy
* **CART (sklearn)** тЖТ Gini (default)

ЁЯСЙ ржмрж╛рж╕рзНрждржмрзЗ ржжрзБржЯрзЛрж░ ржлрж▓рж╛ржлрж▓ ржкрзНрж░рж╛рзЯ ржПржХржЗ рж╣рзЯред

---

## ЁЯОп Decision Tree ржЖрж╕рж▓рзЗ ржХрзА minimize ржХрж░рзЗ?

Decision Tree ржЪрж╛рзЯ:

* **Entropy ржХржорж╛рждрзЗ**
* ржмрж╛ **Gini Impurity ржХржорж╛рждрзЗ**

ржпрзЗ split ржП impurity рж╕ржмржЪрзЗрзЯрзЗ ржмрзЗрж╢рж┐ ржХржорзЗ тЖТ рж╕рзЗржЯрж╛ржЗ best splitред

---

## тЬи ржПржХ рж▓рж╛ржЗржирзЗрж░ Summary

* **Entropy** = ржХрждржЯрж╛ uncertainty ржЖржЫрзЗ
* **Gini** = ржнрзБрж▓ classification рж╣ржУрзЯрж╛рж░ рж╕ржорзНржнрж╛ржмржирж╛
* ржжрзБржЯрзЛржЗ impurity measure
* ржпрзЗржЯрж╛ ржХржо тЖТ node рждржд ржнрж╛рж▓рзЛ

---



