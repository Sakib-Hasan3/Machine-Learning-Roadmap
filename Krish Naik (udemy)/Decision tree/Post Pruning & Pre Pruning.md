# Post Pruning & Pre Pruning

![Image](https://developers.google.com/static/machine-learning/decision-forests/images/ShouldWePrune.png)

![Image](https://miro.medium.com/v2/resize%3Afit%3A1400/1%2AE9zMAgHaNzClDNf1AVBebg.png)

![Image](https://media.geeksforgeeks.org/wp-content/uploads/20240409181231/tree.webp)

---

# ЁЯМ│ Pre-Pruning & Post-Pruning (Decision Tree)

## тЬВя╕П Pruning ржХрзА?

**Pruning** рж╣рж▓рзЛ Decision Tree-ржПрж░ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ рж╢рж╛ржЦрж╛ ржХрзЗржЯрзЗ ржлрзЗрж▓рж╛, ржпрж╛рждрзЗ ржоржбрзЗрж▓ **overfitting** ржирж╛ ржХрж░рзЗ ржПржмржВ ржирждрзБржи ржбрзЗржЯрж╛рзЯ ржнрж╛рж▓рзЛ ржкрж╛рж░ржлрж░рзНржо ржХрж░рзЗред

---

## ЁЯФ╣ Pre-Pruning (Early Stopping)

### ЁЯУМ Pre-Pruning ржХрзА?

Decision Tree **ржкрзБрж░рзЛржкрзБрж░рж┐ ржмрзЬ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ** ржерж╛ржорж┐рзЯрзЗ ржжрзЗржУрзЯрж╛ред

ЁЯСЙ Training ржЪрж▓рж╛ржХрж╛рж▓рзАржиржЗ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржирзЗржУрзЯрж╛ рж╣рзЯтАФsplit ржХрж░рж╛ рж╣ржмрзЗ ржХрж┐ ржирж╛ред

---

### тЪЩя╕П Pre-Pruning ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

ржирж┐ржЪрзЗрж░ ржпрзЗржХрзЛржирзЛ рж╢рж░рзНржд ржкрзВрж░ржг рж╣рж▓рзЗ split ржмржирзНржз ржХрж░рж╛ рж╣рзЯ:

- `max_depth` ржкрзВрж░рзНржг рж╣рж▓рзЗ
- `min_samples_split` ржкрзВрж░ржг ржирж╛ рж╣рж▓рзЗ
- Information Gain / Gini gain ржЦрзБржм ржХржо рж╣рж▓рзЗ

---

### ЁЯза Intuition (рж╕рж╣ржЬ ржзрж╛рж░ржгрж╛)

> тАЬржПржЗ split-ржЯрж╛ ржЦрзБржм ржПржХржЯрж╛ рж▓рж╛ржнржЬржиржХ ржирж╛, ржПржЦрж╛ржирзЗржЗ ржерж╛ржорж┐редтАЭ
> 

---

### тЬЕ Pre-Pruning ржПрж░ рж╕рзБржмрж┐ржзрж╛

- Training ржжрзНрж░рзБржд рж╣рзЯ
- Memory ржХржо рж▓рж╛ржЧрзЗ
- Implement ржХрж░рж╛ рж╕рж╣ржЬ

---

### тЭМ Pre-Pruning ржПрж░ ржЕрж╕рзБржмрж┐ржзрж╛

- **Underfitting** рж╣рждрзЗ ржкрж╛рж░рзЗ
- ржжрж░ржХрж╛рж░рж┐ ржХрж┐ржЫрзБ split ржЖржЧрзЗржЗ ржмржирзНржз рж╣рзЯрзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ

---

### ЁЯзк Example (Conceptual)

- `max_depth = 5`
- `min_samples_split = 10`

---

## ЁЯФ╣ Post-Pruning (Prune After Training)

### ЁЯУМ Post-Pruning ржХрзА?

ржкрзНрж░ржержорзЗ Decision Tree-ржХрзЗ **ржкрзБрж░рзЛржкрзБрж░рж┐ ржмрзЬ рж╣рждрзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯ**, рждрж╛рж░ржкрж░ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ рж╢рж╛ржЦрж╛ ржХрзЗржЯрзЗ ржлрзЗрж▓рж╛ рж╣рзЯред

---

### тЪЩя╕П Post-Pruning ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

1. ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг tree рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯ
2. Validation data ржжрж┐рзЯрзЗ branch-ржПрж░ ржХрж╛рж░рзНржпржХрж╛рж░рж┐рждрж╛ ржжрзЗржЦрж╛ рж╣рзЯ
3. ржпрзЗрж╕ржм branch ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржмрж╛рзЬрж╛рзЯ ржирж╛, рж╕рзЗржЧрзБрж▓рзЛ ржХрзЗржЯрзЗ ржлрзЗрж▓рж╛ рж╣рзЯ

---

### ЁЯза Intuition (рж╕рж╣ржЬ ржзрж╛рж░ржгрж╛)

> тАЬржПржЗ branch-ржЯрж╛ ржХрж╛ржЬрзЗ ржЖрж╕ржЫрзЗ ржирж╛, ржХрзЗржЯрзЗ ржжрж┐ржЗредтАЭ
> 

---

### тЬЕ Post-Pruning ржПрж░ рж╕рзБржмрж┐ржзрж╛

- Overfitting ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржХржорж╛рзЯ
- Generalization ржнрж╛рж▓рзЛ рж╣рзЯ
- ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг split ржЧрзБрж▓рзЛ ржмржЬрж╛рзЯ ржерж╛ржХрзЗ

---

### тЭМ Post-Pruning ржПрж░ ржЕрж╕рзБржмрж┐ржзрж╛

- Training ржзрзАрж░
- Validation data ржжрж░ржХрж╛рж░
- рждрзБрж▓ржирж╛ржорзВрж▓ржХржнрж╛ржмрзЗ ржЬржЯрж┐рж▓

---

## ЁЯЖЪ Pre-Pruning vs Post-Pruning (Comparison)

| ржмрж┐рж╖рзЯ | Pre-Pruning | Post-Pruning |
| --- | --- | --- |
| Pruning ржХржЦржи рж╣рзЯ | Training ржЪрж▓рж╛ржХрж╛рж▓рзАржи | Training рж╢рзЗрж╖рзЗ |
| Speed | ржжрзНрж░рзБржд | ржзрзАрж░ |
| Overfitting control | ржорж╛ржЭрж╛рж░рж┐ | рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА |
| Risk | Underfitting | ржХржо |
| Accuracy | ржХржЦржирзЛ ржХржо | рж╕рж╛ржзрж╛рж░ржгржд ржмрзЗрж╢рж┐ |

---

## ЁЯМ▒ Real-Life Analogy

### ЁЯМ│ Pre-Pruning

ржЧрж╛ржЫ ржмрзЬ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ ржерж╛ржорж┐рзЯрзЗ ржжрзЗржУрзЯрж╛, ржпрж╛рждрзЗ ржмрзЗрж╢рж┐ ржЬржЯрж┐рж▓ ржирж╛ рж╣рзЯред

### тЬВя╕П Post-Pruning

ржЧрж╛ржЫ ржкрзБрж░рзЛ ржмрзЬ рж╣рждрзЗ ржжрзЗржУрзЯрж╛, рждрж╛рж░ржкрж░ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржбрж╛рж▓ ржХрзЗржЯрзЗ ржлрзЗрж▓рж╛ред

---

## ЁЯУМ Common Post-Pruning Techniques

- Cost Complexity Pruning (╬▒-pruning)
- Reduced Error Pruning
- Minimal Error Pruning

---

## ЁЯОп ржХржЦржи ржХрзЛржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?

- ЁЯУК ржЫрзЛржЯ dataset / ржжрзНрж░рзБржд training ржжрж░ржХрж╛рж░ тЖТ **Pre-Pruning**
- ЁЯОп ржмрзЗрж╢рж┐ accuracy ржжрж░ржХрж╛рж░ тЖТ **Post-Pruning**
- ЁЯПн Production model тЖТ **ржжрзБржЯрзЛ ржПржХрж╕рж╛ржерзЗ**

---

## ЁЯза One-Line Summary

> Pre-pruning ржЖржЧрзЗ ржерж╛ржорж╛рзЯ, Post-pruning ржкрж░рзЗ ржХрж╛ржЯрзЗред
>