# ЁЯУШ рж▓рж┐ржирж┐рзЯрж╛рж░ рж░рж┐ржЧрзНрж░рзЗрж╢ржи ржУ OLS (Ordinary Least Squares)

## ЁЯФН рж▓рж┐ржирж┐рзЯрж╛рж░ рж░рж┐ржЧрзНрж░рзЗрж╢ржи ржХрзА?
рж▓рж┐ржирж┐рзЯрж╛рж░ рж░рж┐ржЧрзНрж░рзЗрж╢ржи ржПржХржЯрж┐ **рж╕рзБржкрж╛рж░ржнрж╛ржЗржЬржб рж▓рж╛рж░рзНржирж┐ржВ ржЕрзНржпрж╛рж▓ржЧрж░рж┐ржжржо**, ржпрзЗржЯрж╛ ржорзВрж▓ржд ржжрзБржЗржЯрж┐ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓рзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХ ржмрзЗрж░ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ тАУ ржПржХржЯрж┐ ржЗржиржкрзБржЯ (X) ржПржмржВ ржПржХржЯрж┐ ржЖржЙржЯржкрзБржЯ (Y)ред
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржПржХржЯрж┐ **рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржЦрж╛ (Straight Line)** ржлрж┐ржЯ ржХрж░рж┐ ржпрзЗржЯрж┐ ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ рж╕рзЗрж░рж╛ рж╕ржорзНржкрж░рзНржХржЯрж┐ ржкрзНрж░ржХрж╛рж╢ ржХрж░рзЗред

рж╕рж╛ржзрж╛рж░ржг ржлрж░рзНржорзБрж▓рж╛:
```
y╠В = ╬▓тВА + ╬▓тВБx
```
ржпрзЗржЦрж╛ржирзЗ,
* `y╠В` = ржкрзНрж░рзЗржбрж┐ржХрзНржЯрзЗржб ржЖржЙржЯржкрзБржЯ
* `x` = ржЗржиржкрзБржЯ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓
* `╬▓тВА` = ржЗржирзНржЯрж╛рж░рж╕рзЗржкрзНржЯ (Intercept)
* `╬▓тВБ` = рж╕рзНрж▓рзЛржк / ржХрзЛ-ржЗржлрж┐рж╕рж┐рзЯрзЗржирзНржЯ (Coefficient)

---

## ЁЯзо OLS (Ordinary Least Squares) ржХрзА?
OLS рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржЧрж╛ржгрж┐рждрж┐ржХ ржкржжрзНржзрждрж┐, ржпрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж░рж╛ рж╕рзЗржЗ рж░рзЗржЦрж╛ржЯрж┐ ржмрзЗрж░ ржХрж░рж┐ ржпрж╛рж░ ржЬржирзНржп Y (ржЖрж╕рж▓ ржорж╛ржи) ржПржмржВ y╠В (ржкрзНрж░рзЗржбрж┐ржХрзНржЯрзЗржб ржорж╛ржи)-ржПрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп ржмрж╛ **рждрзНрж░рзБржЯрж┐ (Error)** рж╕ржмржЪрзЗрзЯрзЗ ржХржо рж╣рзЯред

OLS-ржПрж░ рж▓ржХрзНрж╖рзНржп:
> тАЬржкрзНрж░рждрж┐ржЯрж┐ ржбрзЗржЯрж╛ ржкрзЯрзЗржирзНржЯрзЗрж░ ржЬржирзНржп `(yс╡в - y╠Вс╡в)┬▓` ржорж╛ржиржЧрзБрж▓рзЛрж░ ржпрзЛржЧржлрж▓ (Sum of Squared Errors, SSE) рж╕рж░рзНржмржирж┐ржорзНржи ржХрж░рждрзЗ рж╣ржмрзЗредтАЭ

---

## ЁЯза OLS ржжрж┐рзЯрзЗ ╬▓тВБ ржПржмржВ ╬▓тВА ржХрж┐ржнрж╛ржмрзЗ ржмрзЗрж░ ржХрж░ржм?

### 1я╕ПтГг ржХрзЛ-ржЗржлрж┐рж╕рж┐рзЯрзЗржирзНржЯ (╬▓тВБ) ржПрж░ ржлрж░рзНржорзБрж▓рж╛:
```
╬▓тВБ =  ╬г((xс╡в - x╠Д)(yс╡в - ╚│)) / ╬г((xс╡в - x╠Д)┬▓)
```
ЁЯСЙ ржПржЦрж╛ржирзЗ,
* `x╠Д` = X-ржПрж░ ржЧрзЬ
* `╚│` = Y-ржПрж░ ржЧрзЬ
ржПржЯрж┐ ржмрж▓рзЗ ржжрзЗрзЯ: ржЗржиржкрзБржЯ ржПржмржВ ржЖржЙржЯржкрзБржЯрзЗрж░ **рж╕рж╣рж╕ржорзНржкрж░рзНржХ (covariance)** ржнрж╛ржЧ ржХрж░рж╛ рж╣рзЯ ржЗржиржкрзБржЯрзЗрж░ **variance** ржжрж┐рзЯрзЗред

---

### 2я╕ПтГг ржЗржирзНржЯрж╛рж░рж╕рзЗржкрзНржЯ (╬▓тВА) ржПрж░ ржлрж░рзНржорзБрж▓рж╛:
```
╬▓тВА = ╚│ - ╬▓тВБ * x╠Д
```
ржПржЯрж┐ ржмрзЛржЭрж╛рзЯ ржпрзЗ, ржЖржорж░рж╛ ржкрзНрж░рзЗржбрж┐ржХрж╢ржи рж╢рзБрж░рзБ ржХрж░ржм x=0 рждрзЗ y╠В ржХржд рж╣рзЯ, рж╕рзЗржЯрж╛ ржжрж┐рзЯрзЗред

---

## тЬЕ ржЙржжрж╛рж╣рж░ржг ржжрж┐рзЯрзЗ ржмрзЛржЭрж╛ ржпрж╛ржХ

ржзрж░рж╛ ржпрж╛ржХ, ржЖржорж╛ржжрзЗрж░ ржбрзЗржЯрж╛рж╕рзЗржЯ:
```
X = [1, 2, 3, 4, 5]
Y = [2, 4, 5, 4, 5]
```
1. ржкрзНрж░ржержорзЗ x╠Д ржПржмржВ ╚│ ржмрзЗрж░ ржХрж░рж┐:
   ```
   x╠Д = (1+2+3+4+5)/5 = 3
   ╚│ = (2+4+5+4+5)/5 = 4
   ```
2. ╬▓тВБ ржмрзЗрж░ ржХрж░рж┐:
   ```
   ╬▓тВБ = ╬г((xс╡в - x╠Д)(yс╡в - ╚│)) / ╬г((xс╡в - x╠Д)┬▓)
       = [(1тИТ3)(2тИТ4) + (2тИТ3)(4тИТ4) + (3тИТ3)(5тИТ4) + (4тИТ3)(4тИТ4) + (5тИТ3)(5тИТ4)]
       = [(тИТ2)(тИТ2) + (тИТ1)(0) + (0)(1) + (1)(0) + (2)(1)]
       = [4 + 0 + 0 + 0 + 2] = 6
       
       ржПржмржВ ╬г((xс╡в тИТ x╠Д)┬▓) = [(-2)┬▓ + (-1)┬▓ + (0)┬▓ + (1)┬▓ + (2)┬▓] = 10

       ржЕрждржПржм, ╬▓тВБ = 6 / 10 = 0.6
   ```
3. ╬▓тВА ржмрзЗрж░ ржХрж░рж┐:
   ```
   ╬▓тВА = ╚│ тИТ ╬▓тВБ * x╠Д = 4 тИТ 0.6 * 3 = 2.2
   ```
ЁЯСЙ рждрж╛рж╣рж▓рзЗ, ржЖржорж╛ржжрзЗрж░ рж▓рж┐ржирж┐рзЯрж╛рж░ рж░рж┐ржЧрзНрж░рзЗрж╢ржи ржоржбрзЗрж▓:
```
y╠В = 2.2 + 0.6x
```

---

## ЁЯУК рж╕ржВржХрзНрж╖рзЗржкрзЗ:
| ржЙржкрж╛ржжрж╛ржи | ржЕрж░рзНрже                                          |
| ------ | --------------------------------------------- |
| ╬▓тВА     | ржЗржирзНржЯрж╛рж░рж╕рзЗржкрзНржЯ (ржпрзЗржЦрж╛ржирзЗ рж░рзЗржЦрж╛ржЯрж┐ рж╢рзБрж░рзБ рж╣рзЯ)           |
| ╬▓тВБ     | ржкрзНрж░рждрж┐ржЯрж┐ x ржмрж╛рзЬрж▓рзЗ y ржХржд ржмрж╛рзЬрзЗ тАУ рждрж╛рж░ ржкрж░рж┐ржорж╛ржг        |
| OLS    | ржПржоржи рж░рзЗржЦрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ ржпрж╛рждрзЗ рж╕рзНржХрзЯрж╛рж░рзНржб ржПрж░рж░ ржХржо рж╣рзЯ |

---
