## ЁЯФ╣ Hard Margin ржХрзА (SVM / SVC-рждрзЗ)?

![Image](https://www.researchgate.net/profile/Tapan_Bagchi/publication/263716081/figure/download/fig1/AS%3A392444068810765%401470577365764/The-Hard-Margin-SVM-in-the-X1-X2-feature-space.png?utm_source=chatgpt.com)

![Image](https://image2.slideserve.com/4246470/case-1-linearly-separable-data-hard-margin-linear-svm-l.jpg?utm_source=chatgpt.com)

**Hard Margin** рж╣рж▓рзЛ SVM-ржПрж░ ржПржоржи ржПржХржЯрж┐ ржкржжрзНржзрждрж┐ ржпрзЗржЦрж╛ржирзЗ
ЁЯСЙ **ржПржХржЯрж╛ржУ ржбрзЗржЯрж╛ ржкрзЯрзЗржирзНржЯржХрзЗ ржнрзБрж▓ classify ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржжрзЗржУрзЯрж╛ рж╣рзЯ ржирж╛**
ЁЯСЙ **рж╕ржм ржбрзЗржЯрж╛ ржкрзЯрзЗржирзНржЯ margin-ржПрж░ ржмрж╛ржЗрж░рзЗ ржерж╛ржХрждрзЗ рж╣ржмрзЗ**

---

## ЁЯза Hard Margin ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

* ржбрзЗржЯрж╛ **рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ linearly separable** рж╣рждрзЗ рж╣ржмрзЗ
* Margin-ржПрж░ ржнрзЗрждрж░рзЗ **ржХрзЛржирзЛ ржкрзЯрзЗржирзНржЯ ржврзБржХрждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛**
* Hyperplane ржПржоржиржнрж╛ржмрзЗ ржЖржБржХрж╛ рж╣рзЯ ржпрзЗржи

	* рж╕ржм ржкрзЯрзЗржирзНржЯ ржарж┐ржХржнрж╛ржмрзЗ ржЖрж▓рж╛ржжрж╛ рж╣рзЯ
	* Margin ржпрждржЯрж╛ рж╕ржорзНржнржм ржмрзЬ рж╣рзЯ

---

## тЭУ ржХржЦржи Hard Margin ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ?

тЬЕ ржбрзЗржЯрж╛ ржЦрзБржм **ржкрж░рж┐рж╖рзНржХрж╛рж░ (no noise)**
тЬЕ ржХрзЛржирзЛ **outlier ржирзЗржЗ**
тЬЕ ржЫрзЛржЯ ржУ ржЖржжрж░рзНрж╢ ржбрзЗржЯрж╛рж╕рзЗржЯ

ЁЯУМ ржмрж╛рж╕рзНрждржмрзЗ ржПржЯрж╛ ржЦрзБржм ржХржоржЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ

---

## ЁЯЪл Hard Margin-ржПрж░ рж╕ржорж╕рзНржпрж╛

тЭМ рж╕рж╛ржорж╛ржирзНржп noise ржерж╛ржХрж▓рзЗржУ ржХрж╛ржЬ ржХрж░рзЗ ржирж╛
тЭМ Outlier ржерж╛ржХрж▓рзЗ boundary ржЕржирзЗржХ ржмржжрж▓рзЗ ржпрж╛рзЯ
тЭМ Overfitting рж╣ржУрзЯрж╛рж░ ржЭрзБржБржХрж┐ ржмрзЗрж╢рж┐

---

## тЪЦя╕П Hard Margin vs Soft Margin (рж╕рж╣ржЬ рждрзБрж▓ржирж╛)

| ржмрж┐рж╖рзЯ        | Hard Margin | Soft Margin |
| ----------- | ----------- | ----------- |
| ржнрзБрж▓ ржЕржирзБржорждрж┐  | тЭМ ржирж╛        | тЬЕ рж╣рзНржпрж╛ржБ     |
| Noise рж╕рж╣рзНржп  | тЭМ ржирж╛        | тЬЕ рж╣рзНржпрж╛ржБ     |
| Margin      | ржХрзЬрж╛         | Flexible    |
| ржмрж╛рж╕рзНрждржм ржбрзЗржЯрж╛ | ржЦрж╛рж░рж╛ржк       | ржнрж╛рж▓рзЛ        |

---

## ЁЯУР Mathematical Formulation (Hard Margin)

SVM-ржПрж░ Hard Margin ржЕржкрзНржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи рж╕ржорж╕рзНржпрж╛:

$\n\begin{aligned}
\min_{\mathbf{w},\,b} \quad & \frac{1}{2}\,\lVert \mathbf{w} \rVert^2 \\
	ext{s.t.} \quad & y_i\,(\mathbf{x}_i^{\top}\mathbf{w} + b) \ge 1,\quad i=1,\dots,n
\end{aligned}\n$

- рж▓ржХрзНрж╖рзНржп: $\lVert \mathbf{w} \rVert$ ржЫрзЛржЯ рж░рж╛ржЦрж╛ тЖТ ржорж╛рж░рзНржЬрж┐ржи $\tfrac{2}{\lVert \mathbf{w} \rVert}$ ржмрзЬ рж╣рзЯред
- ржХржирзНрж╕ржЯрзНрж░рзЗржЗржирзНржЯ: рж╕ржм ржкрзЯрзЗржирзНржЯ ржарж┐ржХ ржкрж╛рж╢рзЗ ржерж╛ржХржмрзЗ, ржХрж╛рж░ржУ ржЬржирзНржпржЗ $y_i(\mathbf{w}^\top\mathbf{x}_i + b) < 1$ рж╣ржмрзЗ ржирж╛ред

---

## тЩ╛я╕П Soft Margin ржП `C тЖТ тИЮ` рж╣рж▓рзЗ ржХрзА рж╣рзЯ?

Soft Margin (hinge loss) рж╕ржорж╕рзНржпрж╛:

$\n\begin{aligned}
\min_{\mathbf{w},\,b,\,\boldsymbol{\xi}} \quad & \frac{1}{2}\,\lVert \mathbf{w} \rVert^2 + C\sum_{i=1}^{n}\xi_i \\
	ext{s.t.} \quad & y_i\,(\mathbf{x}_i^{\top}\mathbf{w} + b) \ge 1 - \xi_i,\\
& \xi_i \ge 0
\end{aligned}\n$

- ржПржЦрж╛ржирзЗ $\xi_i$ рж╣рж▓рзЛ slack (ржнрзБрж▓ ржмрж╛ ржорж╛рж░рзНржЬрж┐ржирзЗрж░ ржнрзЗрждрж░рзЗ ржврзЛржХрж╛)ред
- ржпржЦржи $C \to \infty$, slack-ржПрж░ ржкрзЗржирж╛рж▓рзНржЯрж┐ ржЕрж╕рзАржо тЖТ рж╕ржорзНржнржм рж╣рж▓рзЗ рж╕ржм $\xi_i = 0$ ржмрж╛ржзрзНржп рж╣рзЯ тЖТ ржарж┐ржХ Hard Margin ржХржирзНрж╕ржЯрзНрж░рзЗржЗржирзНржЯрзЗ ржлрж┐рж░рзЗ ржпрж╛рзЯред
- рждрж╛ржЗ perfect separability ржерж╛ржХрж▓рзЗ Soft Margin + ржмрзЬ `C` тЙИ Hard Marginред

---

## ЁЯУК ржЧрзНрж░рж╛ржл ржУ ржбрзЗржорзЛ

- ржирж┐ржЪрзЗрж░ ржбрзЗржорзЛ рж╕рзНржХрзНрж░рж┐ржкрзНржЯ рж░рж╛ржи ржХрж░рж▓рзЗ ржПржХржЗ ржбрзЗржЯрж╛рждрзЗ Hard (ржЦрзБржм ржмрзЬ `C`) ржмржирж╛ржо Soft (`C=1`) рждрзБрж▓ржирж╛ ржкрзНрж▓ржЯ рж╕рзЗржн рж╣ржмрзЗред
- ржЖржЙржЯржкрзБржЯ ржлрж╛ржЗрж▓: `hard_margin_vs_soft.png`

Run:

```bash
python svc_hard_margin_demo.py
```

ржбрзЗржорзЛ рж╕рзНржХрзНрж░рж┐ржкрзНржЯ: ржжрзЗржЦрзБржи [svc_soft_margin_demo.py](svc_soft_margin_demo.py) ржПржмржВ ржирждрзБржи [svc_hard_margin_demo.py](svc_hard_margin_demo.py)ред

---

## тЬЕ ржПржХ рж▓рж╛ржЗржирзЗ рж░рж┐ржХрзНржпрж╛ржк

- Hard Margin: $y_i(\mathbf{w}^\top \mathbf{x}_i + b) \ge 1$ рж╕ржмрж╛рж░ ржЬржирзНржп, zero toleranceред
- Soft Margin: ржПржХржЗ ржХржирзНрж╕ржЯрзНрж░рзЗржЗржирзНржЯрзЗ slack $\xi_i$ ржпрзБржХрзНржд; ржмрзЬ `C` тЖТ slack ржжржоржи тЖТ separable рж╣рж▓рзЗ Hard Margin-ржПрж░ ржорждрзЛ ржЖржЪрж░ржгред

---

## ЁЯзк ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг (ржорж╛ржЗржирзНржбрж╕рзЗржЯ)

ржнрж╛ржмрзЛ, ржкрж░рзАржХрзНрж╖рж╛рзЯ рж╢рж┐ржХрзНрж╖ржХ ржмрж▓рж▓рзЗржитАФ

> тАЬржПржХржЯрж╛ржУ ржнрзБрж▓ ржЪрж▓ржмрзЗ ржирж╛!тАЭ

ЁЯСЙ ржПржЯрж╛ржЗ **Hard Margin mindset** тАФ ржХрж┐ржирзНрждрзБ ржмрж╛рж╕рзНрждржмрзЗ рж╕рж╛ржзрж╛рж░ржгржд ржПржоржи ржирж┐рзЯржо ржХрж╛ржЬрзЗрж░ ржирж╛ ЁЯШЕ

---

## тЬи ржПржХ рж▓рж╛ржЗржирзЗ ржоржирзЗ рж░рж╛ржЦрзЛ

ЁЯСЙ **Hard Margin = Zero Error, Zero Tolerance**
